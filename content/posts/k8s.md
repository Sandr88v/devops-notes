---
title: "Проверка состояния кластера kubernetes"
slug: k8s
aliases:
  - k8s
weight: 10010
toc_hide: true
tags:
  - k8s
---

## Оцениваем общее состояние

1. Проверяем, насколько совпадает версия клиента и сервера, чтобы не получить несовместимость функционала при дальнейшей работе:

```
kubectl get version
```
2. Дальше смотрим основные ресурсы нашего кластера:

```
kubectl cluster-info (обращаем внимание на ip-адрес, порт, состояние корднс в кластере)
kubectl get cs -A (получаем статус основых компонентов k8s)
```

3. Оценим состояние наших нод и подов, их статус. Выполним команды:

```
kubectl get nodes -A -owide
kubectl get pods -owide
```
Здесь обращаем внимание на время жизни и количество рестартов подов: частые рестарты могут свидетельствовать о проблемах в кластере.

4. Посмотрим на события в кластере за последний час:

```
kubectl get events -owide
```
В выводе этой команды обращаем внимание на то:
- какие поды разворачивались и когда,
- были ли проблемы с хелсчеками,
- не заходил ли oom-киллер и т. п.

5. При установленном metrics-server также можно посмотреть на его нагрузку в кластере:

```
kubectl top nodes
kubectl top pods -A
```
Оценив общее состояние кластера, перейдем к просмотру состояния всех компонентов: здесь может вскрыться очень-очень много интересного.






